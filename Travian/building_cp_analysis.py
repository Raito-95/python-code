import pandas as pd
from openpyxl import load_workbook
from openpyxl.styles import Alignment
from pandas.io.excel import ExcelWriter

buildings_data = {
    "村莊大樓": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [95, 143, 248, 285, 330, 383, 449, 468, 559, 612, 639, 692, 768, 801, 866, 934, 1010, 1077, 1144, 1220]
    },
    "市場": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [85, 194, 266, 340, 422, 458, 511, 580, 666, 691, 779, 825, 902, 956, 1045, 1124, 1187, 1276, 1365, 1461]
    },
    "研究院": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [102, 193, 284, 383, 443, 515, 601, 664, 713, 787, 857, 928, 1006, 1096, 1162, 1253, 1340, 1445, 1535, 1647]
    },
    "大使館": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [108, 204, 301, 406, 470, 546, 638, 704, 755, 833, 907, 983, 1065, 1160, 1231, 1327, 1418, 1530, 1626, 1744]
    },
    "糧倉": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [270, 615, 530, 813, 1178, 1095, 1119, 1500, 1589, 1739, 1946, 1967, 2084, 2277, 2544, 2729, 2870, 3003, 3251, 3512]
    },
    "集結點": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [335, 765, 658, 1008, 1458, 1357, 1388, 1861, 1973, 2162, 2419, 2446, 2592, 2833, 3166, 3395, 3570, 3736, 4045, 4369]
    },
    "馬廄": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [360, 548, 942, 1084, 1254, 1458, 1702, 1775, 2117, 2317, 2420, 2621, 2910, 3036, 3282, 3539, 3826, 4079, 4335, 4621]
    },
    "城牆": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [400, 910, 783, 1203, 1740, 1618, 1654, 2218, 2350, 2573, 2881, 2912, 3086, 3373, 3768, 4041, 4251, 4448, 4816, 5202]
    },
    "倉庫": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [420, 955, 820, 1263, 1825, 1697, 1734, 2324, 2465, 2700, 3023, 3057, 3240, 3541, 3956, 4244, 4463, 4671, 5058, 5462]
    },
    "鐵匠": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [440, 668, 1150, 1325, 1533, 1781, 2079, 2167, 2585, 2830, 2957, 3203, 3556, 3710, 4011, 4326, 4676, 4985, 5298, 5648]
    },
    "工廠": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [473, 1079, 1483, 1897, 2351, 2549, 2842, 3223, 3701, 3840, 4330, 4586, 5012, 5312, 5806, 6250, 6595, 7094, 7586, 8122]
    },
    "兵營": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [730, 1670, 1433, 2198, 3178, 2953, 3019, 4046, 4290, 4697, 5257, 5315, 5632, 6156, 6877, 7376, 7758, 8118, 8791, 9494]
    },
    "行宮": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [785, 1193, 2052, 2361, 2732, 3177, 3709, 3867, 4612, 5050, 5275, 5714, 6344, 6619, 7156, 7717, 8342, 8894, 9453, 10077]
    },
    "市政廳": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [703, 1375, 1838, 2540, 3060, 3415, 3877, 4454, 4767, 5254, 5749, 6144, 6756, 7228, 7744, 8342, 8888, 9527, 10163, 10862]
    },
    "交易所": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [1083, 2466, 3392, 4340, 5381, 5838, 6508, 7382, 8477, 8795, 9919, 10506, 11481, 12169, 13301, 14318, 15109, 16251, 17380, 18608]
    },
    "英雄宅": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [2310, 5380, 4735, 7450, 11063, 10582, 11134, 15385, 16832, 19040, 22036, 23052, 25294, 28642, 33169, 36890, 40248, 43702, 49114, 55069]
    },
    "競技場": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [5770, 13155, 11303, 17355, 25100, 23342, 23850, 31970, 33892, 37113, 41544, 41999, 44509, 48650, 54354, 58299, 61317, 64165, 69478, 75042]
    },
    "醫院": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20],
        "CP值": [27, 1770, 2265, 2890, 1850, 2370, 3032, 2588, 2486, 3182, 2715, 3475, 3813, 4271, 3975, 4665, 4777, 5395, 5336, 6010]
    },
    "山洞": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        "CP值": [130, 300, 255, 393, 565, 525, 536, 719, 762, 834]
    },
    "寶物庫": {
        "等級": [1, 2, 3, 4, 5, 6, 7, 8, 9, 10],
        "CP值": [919, 1745, 2571, 3251, 3997, 4646, 5239, 5990, 6583, 7093]
    }
}

# 組合建築物的資料
combined_data = []

for building, info in buildings_data.items():
    levels = info['等級']
    cp_values = info['CP值']
    for level, cp in zip(levels, cp_values):
        combined_data.append({'建築物名稱': building, '等級': level, 'CP值': cp})

# 將資料轉換為 DataFrame 並排序
df = pd.DataFrame(combined_data)
df_sorted = df.sort_values(by='CP值', ascending=True)

# 使用 pandas 的 ExcelWriter 與 openpyxl 寫入文件並格式化
with pd.ExcelWriter('建築物文明點資源效益排序_v0.1.xlsx', engine='openpyxl') as writer:
    df_sorted.to_excel(writer, index=False)
    
    # 獲取工作簿和工作表
    workbook = writer.book
    worksheet = writer.sheets['Sheet1']
    
    # 設置第一列的寬度和居中對齊
    worksheet.column_dimensions['A'].width = 20
    center_alignment = Alignment(horizontal='center', vertical='center')
    
    for row in worksheet.iter_rows(min_row=2, max_row=worksheet.max_row, min_col=1, max_col=worksheet.max_column):
        building_name_cell = row[0]
        level_cell = row[1]
        
        building_name_cell.alignment = center_alignment
        level_cell.alignment = center_alignment

print("已成功產生 v0.1，並已進行格式化。")
